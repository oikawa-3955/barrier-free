<!DOCTYPE html>
<html lang="ja">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>éƒ½å¸‚å¤§ãƒãƒªã‚¢ãƒ•ãƒªãƒ¼ãƒãƒƒãƒ—</title>
    <style>
      body { margin: 0; padding: 0; font-family: sans-serif; }
      #map { height: 100vh; width: 100%; }

      /* --- â˜…UIãƒ‘ãƒ¼ãƒ„ã®ã‚¹ã‚¿ã‚¤ãƒ«ï¼ˆåœ°å›³ã®ä¸Šã«æµ®ã‹ã›ã‚‹ï¼‰ --- */
      
      /* ä¸Šéƒ¨ã®ãƒ•ã‚£ãƒ«ã‚¿ãƒœã‚¿ãƒ³ç¾¤ */
      .filter-container {
        position: absolute; /* çµ¶å¯¾é…ç½®ã§åœ°å›³ã®ä¸Šã«é‡ã­ã‚‹ */
        top: 10px;
        left: 10px;
        z-index: 5; /* åœ°å›³ã‚ˆã‚Šæ‰‹å‰ã«è¡¨ç¤º */
        display: flex;
        gap: 10px;
      }

      .btn {
        background: white;
        border: none;
        padding: 10px 15px;
        border-radius: 20px; /* ä¸¸ã£ã“ãã—ã¦ã‚¢ãƒ—ãƒªã£ã½ã */
        box-shadow: 0 2px 6px rgba(0,0,0,0.3); /* å½±ã‚’ã¤ã‘ã¦æµ®éŠæ„Ÿã‚’å‡ºã™ */
        font-weight: bold;
        cursor: pointer;
        font-size: 14px;
      }
      .btn:active { background: #eee; }
      .btn-blue { color: #007bff; border: 2px solid #007bff; }
      .btn-all { color: #333; }

      /* å³ä¸‹ã®ç¾åœ¨åœ°ãƒœã‚¿ãƒ³ */
      .gps-btn {
        position: absolute;
        bottom: 25px;
        right: 10px;
        z-index: 5;
        background: white;
        width: 50px;
        height: 50px;
        border-radius: 50%; /* å®Œå…¨ãªå††å½¢ */
        border: none;
        box-shadow: 0 2px 6px rgba(0,0,0,0.3);
        cursor: pointer;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 24px;
      }
    </style>
  </head>
  <body>
    <div class="filter-container">
      <button class="btn btn-all" onclick="filterMap('all')">ã™ã¹ã¦è¡¨ç¤º</button>
      <button class="btn btn-blue" onclick="filterMap('accessible')">â™¿ ãƒãƒªã‚¢ãƒ•ãƒªãƒ¼ã®ã¿</button>
    </div>

    <button class="gps-btn" onclick="getMyLocation()">ğŸ“</button>

    <div id="map"></div>

    <script>
      let map; // ä»–ã®é–¢æ•°ã‹ã‚‰ã‚‚ä½¿ãˆã‚‹ã‚ˆã†ã«å¤–ã«å‡ºã™
      let markers = []; // ä½œã£ãŸãƒ”ãƒ³ã‚’ç®¡ç†ã™ã‚‹ãŸã‚ã®ãƒªã‚¹ãƒˆ

      function initMap() {
        const targetLocation = { lat: 35.598352, lng: 139.650828 };

        // åœ°å›³ã®ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«ï¼ˆå³ä¸‹ã®ï¼‹ï¼ãƒœã‚¿ãƒ³ãªã©ï¼‰ã‚’æ¶ˆã—ã¦ã‚¹ãƒƒã‚­ãƒªã•ã›ã‚‹è¨­å®š
        map = new google.maps.Map(document.getElementById("map"), {
          center: targetLocation,
          zoom: 17,
          disableDefaultUI: true, // â˜…ã“ã‚Œã§ä¸€æ°—ã«ã‚¢ãƒ—ãƒªã£ã½ã„è¦‹ãŸç›®ã«ãªã‚Šã¾ã™
          zoomControl: true,      // ã‚ºãƒ¼ãƒ ãƒœã‚¿ãƒ³ã ã‘ã¯æ®‹ã™
        });

        const spots = [
          { name: "æ±äº¬éƒ½å¸‚å¤§å­¦ ä¸–ç”°è°·ã‚­ãƒ£ãƒ³ãƒ‘ã‚¹", lat: 35.598352, lng: 139.651045, status: 0 },
          { name: "1å·é¤¨ï¼ˆæ¨™æº–ãƒ”ãƒ³ï¼‰", lat: 35.599108, lng: 139.650828, status: 1 },
          { name: "2å·é¤¨ï¼ˆæ¨™æº–ãƒ”ãƒ³ï¼‰", lat: 35.599256, lng: 139.651566, status: 1 },
          { name: "3å·é¤¨ï¼ˆæ¨™æº–ãƒ”ãƒ³ï¼‰", lat: 35.598915, lng: 139.651366, status: 1 },
          { name: "å›³æ›¸é¤¨ï¼ˆãƒãƒªã‚¢ãƒ•ãƒªãƒ¼ï¼‰", lat: 35.59824931232551, lng: 139.65043268191414, status: 2 }, // ä»®ã®ãƒ‡ãƒ¼ã‚¿è¿½åŠ 
        ];

        spots.forEach((spot) => {
          let iconUrl = null; 
          // status: 0 (ãƒãƒªã‚¢ãƒ•ãƒªãƒ¼) ã®æ™‚ã ã‘é’ã„ã‚¢ã‚¤ã‚³ãƒ³
          if (spot.status === 0) {
            iconUrl = "http://maps.google.com/mapfiles/ms/icons/blue-dot.png"; 
          }

          const marker = new google.maps.Marker({
            position: { lat: spot.lat, lng: spot.lng },
            map: map,
            title: spot.name,
            icon: iconUrl,
          });
          
          // â˜…ã‚ã¨ã§æ“ä½œã§ãã‚‹ã‚ˆã†ã«ã€ãƒãƒ¼ã‚«ãƒ¼è‡ªä½“ã«statusæƒ…å ±ã‚’åŸ‹ã‚è¾¼ã‚“ã§ãƒªã‚¹ãƒˆã«ä¿å­˜
          marker.customStatus = spot.status; 
          markers.push(marker);
        });
      }

      // --- â˜…æ©Ÿèƒ½è¿½åŠ : ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚° ---
      function filterMap(type) {
        markers.forEach((marker) => {
          if (type === 'all') {
            marker.setVisible(true); // å…¨å“¡è¡¨ç¤º
          } else if (type === 'accessible') {
            // statusãŒ2ï¼ˆãƒãƒªã‚¢ãƒ•ãƒªãƒ¼ï¼‰ãªã‚‰è¡¨ç¤ºã€ãã‚Œä»¥å¤–ã¯éè¡¨ç¤º
            if (marker.customStatus === 2) {
              marker.setVisible(true);
            } else {
              marker.setVisible(false);
            }
          }
        });
      }

      // --- â˜…æ©Ÿèƒ½è¿½åŠ : GPSç¾åœ¨åœ°å–å¾— ---
      function getMyLocation() {
        // ãƒ–ãƒ©ã‚¦ã‚¶ãŒä½ç½®æƒ…å ±ã«å¯¾å¿œã—ã¦ã„ã‚‹ã‹ç¢ºèª
        if (navigator.geolocation) {
          navigator.geolocation.getCurrentPosition(
            (position) => {
              const pos = {
                lat: position.coords.latitude,
                lng: position.coords.longitude,
              };

              // ç¾åœ¨åœ°ã«é’ã„å††ã‚’æç”»ï¼ˆè‡ªåˆ†ï¼‰
              new google.maps.Marker({
                position: pos,
                map: map,
                icon: {
                  path: google.maps.SymbolPath.CIRCLE,
                  scale: 10,
                  fillColor: "#4285F4", // Googleãƒ–ãƒ«ãƒ¼
                  fillOpacity: 1,
                  strokeWeight: 2,
                  strokeColor: "white",
                },
                title: "ç¾åœ¨åœ°",
              });

              map.setCenter(pos); // åœ°å›³ã®ä¸­å¿ƒã‚’ç§»å‹•
              map.setZoom(19);    // ã‚ºãƒ¼ãƒ ã‚¤ãƒ³
            },
            () => {
              alert("ä½ç½®æƒ…å ±ã®å–å¾—ã«å¤±æ•—ã—ã¾ã—ãŸã€‚");
            }
          );
        } else {
          alert("ã“ã®ãƒ–ãƒ©ã‚¦ã‚¶ã¯ä½ç½®æƒ…å ±ã«å¯¾å¿œã—ã¦ã„ã¾ã›ã‚“ã€‚");
        }
      }
    </script>

    <script
      src="https://maps.googleapis.com/maps/api/js?key=AIzaSyATB9-p7wIeRz1W0ZKvKtkNCRMokUxb5aw&callback=initMap"
      async
      defer
    ></script>
  </body>
</html>